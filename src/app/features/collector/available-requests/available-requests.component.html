<div class="min-h-screen py-8 px-4 md:px-6 lg:px-8 pb-24 md:pb-8">
  <div class="max-w-7xl mx-auto space-y-8">
    <div
      class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"
    >
      <div>
        <h1 class="text-3xl md:text-4xl font-bold text-foreground">
  üì¶ {{ 'COLLECTOR.AVAILABLE.TITLE' | translate }}
        </h1>
        <p class="text-muted-foreground mt-2">  {{ 'COLLECTOR.AVAILABLE.SUBTITLE' | translate }}
</p>
        <p class="text-sm text-warning mt-1" *ngIf="!canAcceptOrder()">
  ‚ö†Ô∏è {{ 'COLLECTOR.AVAILABLE.LIMIT_WARNING' | translate:{
      current: getActiveOrderCount(),
      max: maxActiveOrders
  } }}        </p>
      </div>
    </div>
    <app-card-content>
      <div class="space-y-4 max-h-[600px] overflow-y-auto pr-2">
        @for (request of pendingRequests(); track request.id) {
        <div
          class="border border-border rounded-xl p-4 hover:shadow-lg hover:border-primary/40 transition-all cursor-pointer group bg-white"
          (click)="onCardClick(request)"
        >
          <!-- Header with Order ID and Status -->
          <div class="flex items-center justify-between mb-3">
            <div>
              <h3 class="font-bold text-base text-card-foreground">
                üîÑ Order #{{ request.id }}
                @if (request.orderDate) {
                <span class="font-semibold text-card-foreground">{{
                  " , " + formatDate(request.orderDate)
                }}</span>
                }
              </h3>
              <!-- <p class="text-xs text-muted-foreground">{{ request.userName }}</p> -->
            </div>
            <div class="text-right">
              <app-badge [variant]="getBadgeVariant(request.status)">
                {{ getStatusText(request.status) }}
              </app-badge>
            </div>
          </div>

          <!-- From & To Section -->
          <div class="grid grid-cols-2 gap-3 mb-3">
            <!-- FROM: Pickup Location -->
            <div
              class="p-3 border-l-4 border-l-blue-500 bg-blue-50/50 rounded-lg"
            >
              <p
                class="text-xs font-bold text-blue-700 uppercase tracking-wide mb-1"
              >
üìç {{ 'COLLECTOR.FROM_PICKUP' | translate }}
              </p>
              <div class="text-xs space-y-1">
                <p class="font-semibold text-gray-800">
                  {{ request.userName }}
                </p>
                @if (request.street) {
                <p class="text-gray-700">{{ 'COMMON.STREET' | translate }}
 {{ request.street }}</p>
                } @if (request.buildingNo) {
                <p class="text-gray-700">{{ 'COMMON.BUILDING' | translate }}
 {{ request.buildingNo }}</p>
                } @if (request.apartment) {
                <p class="text-gray-700">{{ 'COMMON.APARTMENT' | translate }}
 {{ request.apartment }}</p>
                } @if (request.city) {
                <p class="text-gray-700">{{ 'COMMON.CITY' | translate }}
 {{ request.city }}</p>
                }
              </div>
            </div>

            <!-- TO: Delivery Location -->
            <div
              class="p-3 border-l-4 border-l-green-500 bg-green-50/50 rounded-lg"
            >
              <p
                class="text-xs font-bold text-green-700 uppercase tracking-wide mb-1"
              >
üè≠ {{ 'COLLECTOR.TO_DELIVERY' | translate }}
              </p>
              <div class="text-xs space-y-1">
                @if (request.factoryName) {
                <p class="font-semibold text-gray-800">
                  {{ request.factoryName }}
                </p>
                } @if (request.factoryArea) {
                <p class="text-gray-700">{{ 'COMMON.AREA' | translate }}
 {{ request.factoryArea }}</p>
                } @if (request.factoryStreet) {
                <p class="text-gray-700">{{ 'COMMON.STREET' | translate }} {{ request.factoryStreet }}</p>
                } @if (request.factoryBuildingNo) {
                <p class="text-gray-700">
                  {{ 'COMMON.BUILDING' | translate }}
 {{ request.factoryBuildingNo }}
                </p>
                } @if (request.factoryCity) {
                <p class="text-gray-700">{{ 'COMMON.CITY' | translate }}
 {{ request.factoryCity }}</p>
                }
              </div>
            </div>
          </div>

          <!-- Details Row -->
<!-- Details Row -->
<div class="grid grid-cols-3 gap-2 text-xs text-muted-foreground mb-3 py-2 border-y border-border/30">

  <!-- Material -->
  @if (request.typeOfMaterial) {
    <div class="flex items-center gap-2">
      <span class="text-base">üß±</span>
      <div>
        <p class="text-muted-foreground">{{ 'COMMON.MATERIAL' | translate }}
</p>
        <p class="font-semibold text-card-foreground">
          {{ request.typeOfMaterial }}
        </p>
      </div>
    </div>
  }

  <!-- Quantity -->
  @if (request.quantity !== null && request.quantity !== undefined) {
    <div class="flex items-center gap-2">
      <span class="text-base">‚öñÔ∏è</span>
      <div>
        <p class="text-muted-foreground">{{ 'COMMON.QUANTITY' | translate }}
</p>
        <p class="font-semibold text-card-foreground">
          {{ request.quantity }} kg
        </p>
      </div>
    </div>
  }

  <!-- Date -->
  @if (request.orderDate) {
    <div class="flex items-center gap-2">
      <span class="text-base">üìÖ</span>
      <div>
        <p class="text-muted-foreground">{{ 'COMMON.DATE' | translate }}
 </p>
        <p class="font-semibold text-card-foreground">
          {{ formatDate(request.orderDate) }}
        </p>
      </div>
    </div>
  }

</div>


          <!-- Contact Info -->
          @if (request.email) {
            <div class="text-xs text-muted-foreground mb-3 flex items-center gap-2">
              <span>üìß</span>
              <span class="truncate">{{ request.email }}</span>
            </div>
          }

          <!-- Action Button -->
          @if (request.status.toLowerCase() === 'pending') {
          <button
            [disabled]="!canAcceptOrder()"
            class="w-full py-2.5 px-3 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white text-sm font-bold rounded-lg transition-all shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed disabled:from-gray-400 disabled:to-gray-500"
            (click)="acceptOrder(request.id); $event.stopPropagation()"
          >
            {{ 'COLLECTOR.ACTIONS.ACCEPT' | translate }}

          </button>
          } @if (request.status.toLowerCase() === 'accepted') {
          <button
            class="w-full py-2.5 px-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white text-sm font-bold rounded-lg transition-all shadow-sm hover:shadow-md"
            (click)="
              changeStatus(request.id, 'Collected'); $event.stopPropagation()
            "
          >
{{ 'COLLECTOR.ACTIONS.MARK_COLLECTED' | translate }}
          </button>
          } @if (request.status.toLowerCase() === 'collected') {
          <button
            class="w-full py-2.5 px-3 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white text-sm font-bold rounded-lg transition-all shadow-sm hover:shadow-md"
            (click)="
              changeStatus(request.id, 'Delivered'); $event.stopPropagation()
            "
          >
{{ 'COLLECTOR.ACTIONS.MARK_DELIVERED' | translate }}
          </button>
          }
        </div>
        }

        <!-- Empty State -->
        @if (pendingRequests().length === 0) {
        <div class="text-center py-16 text-muted-foreground">
          <span class="text-6xl block mb-4">üì¶</span>
<p class="font-semibold text-lg">
  {{ 'COLLECTOR.EMPTY.NO_AVAILABLE' | translate }}
</p>

<p class="text-sm mt-2">
  {{ 'COLLECTOR.EMPTY.NO_AVAILABLE_DESC' | translate }}
</p>
        </div>
        }
      </div>
    </app-card-content>
  </div>
</div>
