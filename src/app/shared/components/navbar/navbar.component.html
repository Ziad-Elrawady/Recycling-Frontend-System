<!-- ================= ğŸ–¥ï¸ Desktop Navbar ================= -->
<nav class="navbar-desktop">
  <div class="navbar-container">

    <!-- ===== Left ===== -->
    <div class="navbar-left">

      <!-- Logo -->
      <a class="logo-link logo-btn" (click)="goHomeAndReset()">
        <div class="logo-icon">
          <img src="assets/GreenZone Logo.png" alt="GreenZone Logo" />
        </div>
        <span class="logo-text">Green Zone</span>
      </a>

      <!-- ===== Role Based Links ===== -->
      @if (isLoggedIn() && !isAuthRoute()) {

        <!-- ================= ADMIN ================= -->
        @if (isAdmin()) {
          <div class="nav-links admin-links">
            <a routerLink="/admin/dashboard" routerLinkActive="active" class="nav-link">Dashboard</a>
            <a routerLink="/admin/materials" routerLinkActive="active" class="nav-link">Materials</a>
            <a routerLink="/admin/factories" routerLinkActive="active" class="nav-link">Factories</a>
            <a routerLink="/admin/orders" routerLinkActive="active" class="nav-link">Orders</a>
            <a routerLink="/admin/users" routerLinkActive="active" class="nav-link">Users</a>
            <a routerLink="/admin/rewards" routerLinkActive="active" class="nav-link">Rewards</a>
            <a routerLink="/admin/collectors" routerLinkActive="active" class="nav-link">Collectors</a>
            <a routerLink="/admin/add-collector" routerLinkActive="active" class="nav-link">Add Collector</a>
          </div>
        }

        <!-- ================= COLLECTOR ================= -->
        @if (isCollector()) {
          <div class="nav-links">
            <a routerLink="/collector-dashboard" routerLinkActive="active" class="nav-link">Dashboard</a>
            <a routerLink="/collector-requests" routerLinkActive="active" class="nav-link">My Orders</a>
          </div>
        }

        <!-- ================= USER ================= -->
        @if (isUser()) {
          <div class="nav-links">
            <a routerLink="/citizen-dashboard" routerLinkActive="active" class="nav-link">Dashboard</a>

            <a routerLink="/rewards" routerLinkActive="active" class="nav-link">
              Rewards
              <!-- @if (userPoints()) {
                <span class="points-badge">{{ userPoints() }}</span>
              } -->
            </a>

            <a routerLink="/my-requests" routerLinkActive="active" class="nav-link">
              My Requests
            </a>
          </div>
        }

      }
    </div>

    <!-- ===== Right ===== -->
    <div class="navbar-right">

      <!-- ğŸ”” Notifications (User + Collector ÙÙ‚Ø·) -->
      @if (isLoggedIn() && !isAuthRoute() && !isAdmin()) {
        <div class="relative">
          <button
            type="button"
            class="action-btn"
            (click)="toggleNotifications($event)"
          >
            <i class="fa-regular fa-bell"></i>
          </button>

          @if (showNotificationsDropdown()) {
            <div class="dropdown-overlay" (click)="closeDropdowns()"></div>

            <div class="dropdown-menu">
              <a routerLink="/notifications" class="dropdown-item">
                View all notifications
              </a>
            </div>
          }
        </div>
      }

      <!-- ğŸŒ Language -->
      <button
        type="button"
        class="action-btn"
        (click)="languageService.toggleLanguage()"
      >
        <i class="fa-solid fa-globe"></i>
      </button>

      <!-- ğŸŒ™ / â˜€ï¸ Theme -->
      <button
        type="button"
        class="action-btn"
        (click)="themeService.toggleTheme()"
      >
        <i
          class="fa-solid"
          [class.fa-moon]="themeService.theme() === 'light'"
          [class.fa-sun]="themeService.theme() !== 'light'">
        </i>
      </button>

      <!-- ğŸ‘¤ User Menu (User + Collector) -->
      @if (isLoggedIn() && !isAdmin()) {
<div class="relative">

  <button
    class="user-menu-btn"
    (click)="toggleUserMenu($event)"
  >
    <div class="user-info">
      <span class="user-name">{{ displayName() }}</span>
      <span class="user-role">{{ roleLabel() }}</span>
    </div>
    <span class="dropdown-arrow">â–¼</span>
  </button>

@if (showUserMenu()) {
  <div class="dropdown-menu">

    <!-- ğŸ‘¤ Basic Info -->
    <div class="dropdown-item" style="cursor: default;">
      <div>
        <strong>{{ displayName() }}</strong><br />
        <small>{{ profileService.userProfile()?.email }}</small>
      </div>
    </div>

    <div class="dropdown-separator"></div>

    <!-- ğŸ“ Phone -->
    <div class="dropdown-item" style="cursor: default;">
      ğŸ“ Phone:
      <strong>{{ profileService.userProfile()?.phoneNumber }}</strong>
    </div>

    <!-- ğŸ  Address -->
    @if (profileService.userProfile()?.street) {
      <div class="dropdown-item" style="cursor: default;">
        ğŸ  Address:
        <strong>
          {{ profileService.userProfile()?.street }},
          {{ profileService.userProfile()?.city }}
        </strong>
      </div>
    }

    <!-- ğŸ¢ Building / Apartment -->
    @if (profileService.userProfile()?.buildingNo) {
      <div class="dropdown-item" style="cursor: default;">
        ğŸ¢ Building:
        <strong>
          {{ profileService.userProfile()?.buildingNo }}
          / {{ profileService.userProfile()?.apartment }}
        </strong>
      </div>
    }

    <div class="dropdown-separator"></div>

    <!-- ğŸ Points -->
    <div class="dropdown-item" style="cursor: default;">
      ğŸ Reward Points:
      <strong>{{ profileService.userProfile()?.points ?? 0 }}</strong>
    </div>

    <div class="dropdown-separator"></div>

    <!-- ğŸ“Š Dashboard -->
    <div class="dropdown-item" (click)="goToDashboard()">
      ğŸ“Š Dashboard
    </div>

    <div class="dropdown-separator"></div>

    <!-- ğŸšª Logout -->
    <div class="dropdown-item logout-btn" (click)="logout()">
      ğŸšª Logout
    </div>

  </div>
}
</div>

      }
      @if (isLoggedIn()) {
  <button class="btn-ghost logout-direct" (click)="logout()">
    Logout
  </button>
}

        @if (isAdmin() && isCollector()) {
  <button class="btn-ghost logout-direct" (click)="logout()">
    Logout
  </button>
}
      <!-- ğŸ‘‹ Guest -->
      @if (!isLoggedIn() && !isAuthRoute()) {
        <a routerLink="/login" class="btn-ghost1">Login</a>
        <a routerLink="/register" class="btn-primary">Get Started</a>
      }

    </div>
  </div>
</nav>

<!-- ================= ğŸ“± Mobile Bottom Navbar ================= -->
<!-- @if (isLoggedIn() && !isAuthRoute() && !isAdmin()) {
  <nav class="navbar-mobile-bottom"> -->

    <!-- Admin -->
    <!-- @if (isAdmin()) {
      <a routerLink="/admin/dashboard" routerLinkActive="active" class="mobile-nav-item">ğŸ“Š</a>
      <a routerLink="/admin/orders" routerLinkActive="active" class="mobile-nav-item">ğŸ“¦</a>
      <a routerLink="/admin/users" routerLinkActive="active" class="mobile-nav-item">ğŸ‘¥</a>
    } -->

    <!-- Collector -->
    <!-- @if (isCollector()) {
      <a routerLink="/collector-dashboard" routerLinkActive="active" class="mobile-nav-item">ğŸ“</a>
      <a routerLink="/my-requests" routerLinkActive="active" class="mobile-nav-item">ğŸ“¦</a>
    } -->

    <!-- User -->
    <!-- @if (isUser()) {
      <a routerLink="/citizen-dashboard" routerLinkActive="active" class="mobile-nav-item">ğŸ </a>
      <a routerLink="/rewards" routerLinkActive="active" class="mobile-nav-item">ğŸ</a>
      <a routerLink="/my-requests" routerLinkActive="active" class="mobile-nav-item">ğŸ“„</a>
    } -->

    <!-- Logout -->
    <!-- <button class="mobile-nav-item logout-mobile" (click)="logout()">ğŸšª</button>
  </nav>
} -->
